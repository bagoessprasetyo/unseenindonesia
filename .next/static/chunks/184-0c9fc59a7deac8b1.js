"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[184],{1076:function(e,s,a){a.d(s,{Z:function(){return j}});var t=a(7437),r=a(2265),n=a(7648),l=a(9376),i=a(2048),c=a(9317),o=a(1769),d=a(3774),u=a(3247),m=a(4766),x=a(2369),h=a(8728),g=a(7692),f=a(2489),p=a(8293),v=a(9397),b=a(8655);function j(e){let{children:s}=e,[a,j]=(0,r.useState)(!1),[y,N]=(0,r.useState)(!1),{user:w,profile:_,signOut:Z}=(0,b.a)(),k=(0,l.useRouter)(),C=(0,l.usePathname)(),I=[{name:"Peta",href:"/",icon:i.Z,current:"/"===C},{name:"Jelajahi",href:"/explore",icon:c.Z,current:"/explore"===C},{name:"Cerita",href:"/stories",icon:o.Z,current:"/stories"===C}],S=async()=>{await Z(),N(!1)};return(0,t.jsxs)("div",{className:"min-h-screen bg-gray-50",children:[(0,t.jsxs)("header",{className:"bg-white shadow-sm border-b border-gray-200 sticky top-0 z-50",children:[(0,t.jsx)("div",{className:"mx-auto max-w-7xl px-4 sm:px-6 lg:px-8",children:(0,t.jsxs)("div",{className:"flex h-16 justify-between items-center",children:[(0,t.jsx)("div",{className:"flex items-center",children:(0,t.jsxs)(n.default,{href:"/",className:"flex items-center gap-3",children:[(0,t.jsx)("div",{className:"w-8 h-8 bg-indonesia-red rounded-lg flex items-center justify-center",children:(0,t.jsx)(d.Z,{className:"w-5 h-5 text-white"})}),(0,t.jsx)("span",{className:"text-xl font-accent font-bold text-gray-900 hidden sm:block",children:"UnseenIndonesia"})]})}),(0,t.jsx)("nav",{className:"hidden md:flex space-x-8",children:I.map(e=>(0,t.jsxs)(n.default,{href:e.href,className:"flex items-center gap-2 px-3 py-2 rounded-md text-sm font-medium transition-colors ".concat(e.current?"text-indonesia-red bg-red-50":"text-gray-500 hover:text-gray-900 hover:bg-gray-100"),children:[(0,t.jsx)(e.icon,{className:"w-4 h-4"}),e.name]},e.name))}),(0,t.jsx)("div",{className:"hidden md:flex flex-1 max-w-lg mx-8",children:(0,t.jsxs)("div",{className:"relative w-full",children:[(0,t.jsx)("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:(0,t.jsx)(u.Z,{className:"h-5 w-5 text-gray-400"})}),(0,t.jsx)("input",{type:"text",className:"block w-full pl-10 pr-3 py-2 border border-gray-300 rounded-md leading-5 bg-white placeholder-gray-500 focus:outline-none focus:placeholder-gray-400 focus:ring-1 focus:ring-indonesia-red focus:border-indonesia-red",placeholder:"Cari cerita, lokasi, atau periode..."})]})}),(0,t.jsxs)("div",{className:"flex items-center gap-4",children:[w&&(0,t.jsxs)("button",{className:"p-2 text-gray-400 hover:text-gray-500 relative",children:[(0,t.jsx)(m.Z,{className:"w-5 h-5"}),(0,t.jsx)("span",{className:"absolute top-1 right-1 w-2 h-2 bg-indonesia-red rounded-full"})]}),w?(0,t.jsxs)("div",{className:"relative",children:[(0,t.jsxs)("button",{onClick:()=>N(!y),className:"flex items-center gap-3 p-2 rounded-md hover:bg-gray-100 transition-colors",children:[(0,t.jsx)("div",{className:"w-8 h-8 bg-indonesia-gold rounded-full flex items-center justify-center",children:(null==_?void 0:_.avatar_url)?(0,t.jsx)("img",{src:_.avatar_url,alt:_.full_name||"User",className:"w-8 h-8 rounded-full object-cover"}):(0,t.jsx)(x.Z,{className:"w-4 h-4 text-white"})}),(0,t.jsx)("span",{className:"hidden md:block text-sm font-medium text-gray-700",children:(null==_?void 0:_.full_name)||(null==_?void 0:_.username)||"User"})]}),y&&(0,t.jsx)("div",{className:"absolute right-0 mt-2 w-56 bg-white rounded-md shadow-lg ring-1 ring-black ring-opacity-5 z-50",children:(0,t.jsxs)("div",{className:"py-1",children:[(0,t.jsxs)("div",{className:"px-4 py-3 border-b border-gray-100",children:[(0,t.jsx)("p",{className:"text-sm font-medium text-gray-900",children:(null==_?void 0:_.full_name)||(null==_?void 0:_.username)}),(0,t.jsx)("p",{className:"text-sm text-gray-500",children:w.email})]}),(0,t.jsxs)(n.default,{href:"/profile",className:"flex items-center gap-3 px-4 py-2 text-sm text-gray-700 hover:bg-gray-100",onClick:()=>N(!1),children:[(0,t.jsx)(x.Z,{className:"w-4 h-4"}),"Profil Saya"]}),(0,t.jsxs)(n.default,{href:"/settings",className:"flex items-center gap-3 px-4 py-2 text-sm text-gray-700 hover:bg-gray-100",onClick:()=>N(!1),children:[(0,t.jsx)(h.Z,{className:"w-4 h-4"}),"Pengaturan"]}),(0,t.jsxs)("button",{onClick:S,className:"flex items-center gap-3 w-full px-4 py-2 text-sm text-gray-700 hover:bg-gray-100",children:[(0,t.jsx)(g.Z,{className:"w-4 h-4"}),"Keluar"]})]})})]}):(0,t.jsx)(n.default,{href:"/auth",className:"bg-indonesia-red text-white px-4 py-2 rounded-md text-sm font-medium hover:bg-indonesia-deep-red transition-colors",children:"Masuk"}),(0,t.jsx)("button",{className:"md:hidden p-2 rounded-md text-gray-400 hover:text-gray-500 hover:bg-gray-100",onClick:()=>j(!a),children:a?(0,t.jsx)(f.Z,{className:"w-6 h-6"}):(0,t.jsx)(p.Z,{className:"w-6 h-6"})})]})]})}),a&&(0,t.jsx)("div",{className:"md:hidden",children:(0,t.jsxs)("div",{className:"px-2 pt-2 pb-3 space-y-1 bg-white border-t border-gray-200",children:[(0,t.jsx)("div",{className:"px-3 py-2",children:(0,t.jsxs)("div",{className:"relative",children:[(0,t.jsx)("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:(0,t.jsx)(u.Z,{className:"h-5 w-5 text-gray-400"})}),(0,t.jsx)("input",{type:"text",className:"block w-full pl-10 pr-3 py-2 border border-gray-300 rounded-md leading-5 bg-white placeholder-gray-500 focus:outline-none focus:placeholder-gray-400 focus:ring-1 focus:ring-indonesia-red focus:border-indonesia-red",placeholder:"Cari cerita..."})]})}),I.map(e=>(0,t.jsxs)(n.default,{href:e.href,className:"flex items-center gap-3 px-3 py-2 rounded-md text-base font-medium ".concat(e.current?"text-indonesia-red bg-red-50":"text-gray-600 hover:text-gray-900 hover:bg-gray-100"),onClick:()=>j(!1),children:[(0,t.jsx)(e.icon,{className:"w-5 h-5"}),e.name]},e.name))]})})]}),(0,t.jsx)("main",{className:"flex-1",children:s}),w&&(0,t.jsx)("button",{onClick:()=>k.push("/stories/new"),className:"fixed bottom-6 right-6 w-14 h-14 bg-indonesia-red text-white rounded-full shadow-lg hover:bg-indonesia-deep-red transition-all duration-200 transform hover:scale-105 flex items-center justify-center z-40 animate-pulse",title:"Tambah Cerita Baru",children:(0,t.jsx)(v.Z,{className:"w-6 h-6"})}),(a||y)&&(0,t.jsx)("div",{className:"fixed inset-0 bg-black bg-opacity-25 z-30",onClick:()=>{j(!1),N(!1)}})]})}},8655:function(e,s,a){a.d(s,{Providers:function(){return o},a:function(){return c}});var t=a(7437),r=a(2265),n=a(9376),l=a(5526);let i=(0,r.createContext)(void 0);function c(){let e=(0,r.useContext)(i);if(void 0===e)throw Error("useAuth must be used within a Providers component");return e}function o(e){let{children:s}=e,[a,c]=(0,r.useState)(null),[o,d]=(0,r.useState)(null),[u,m]=(0,r.useState)(null),[x,h]=(0,r.useState)(!0),g=(0,n.useRouter)(),f=(0,n.usePathname)(),p=(0,l.JU)();(0,r.useEffect)(()=>{(async()=>{var e;let{data:{session:s},error:a}=await p.auth.getSession();if(a){console.error("Error getting session:",a),h(!1);return}if(m(s),c(null!==(e=null==s?void 0:s.user)&&void 0!==e?e:null),null==s?void 0:s.user){let{data:e}=await p.from("profiles").select("*").eq("id",s.user.id).single();d(e)}h(!1)})();let{data:{subscription:e}}=p.auth.onAuthStateChange(async(e,s)=>{var a,t,r,n,l,i,o;if(m(s),c(null!==(a=null==s?void 0:s.user)&&void 0!==a?a:null),null==s?void 0:s.user){let{data:e,error:a}=await p.from("profiles").select("*").eq("id",s.user.id).single();if(a&&"PGRST116"===a.code){let{data:e}=await p.from("profiles").insert({id:s.user.id,username:(null===(t=s.user.email)||void 0===t?void 0:t.split("@")[0])||"",full_name:(null===(r=s.user.user_metadata)||void 0===r?void 0:r.full_name)||(null===(n=s.user.user_metadata)||void 0===n?void 0:n.name)||"",avatar_url:(null===(l=s.user.user_metadata)||void 0===l?void 0:l.avatar_url)||(null===(i=s.user.user_metadata)||void 0===i?void 0:i.picture)||null,location:(null===(o=s.user.user_metadata)||void 0===o?void 0:o.location)||null}).select().single();d(e)}else d(e)}else d(null);"SIGNED_IN"===e&&"/auth"===f?g.push("/"):"SIGNED_OUT"===e&&g.push("/auth")});return()=>e.unsubscribe()},[p,g,f]);let v=async()=>{await p.auth.signOut()};return(0,t.jsx)(i.Provider,{value:{user:a,profile:o,session:u,loading:x,signOut:v},children:s})}},8778:function(e,s,a){a.d(s,{E:function(){return p}});var t=a(7437),r=a(2265),n=a(3145),l=a(2990),i=a(7714),c=a(9322),o=a(1723),d=a(1671),u=a(1769),m=a(6595),x=a(3774),h=a(2208),g=a(5805),f=a(2369);function p(e){var s,a,p,v;let{story:b,onClick:j,compact:y=!1,showAuthor:N=!0}=e,[w,_]=(0,r.useState)(!1),Z=(e=>{switch(e){case 0:return{color:"bg-red-100 text-red-700",icon:c.Z,text:"Baru"};case 1:return{color:"bg-yellow-100 text-yellow-700",icon:o.Z,text:"Menarik"};case 2:return{color:"bg-green-100 text-green-700",icon:d.Z,text:"Terverifikasi"};case 3:return{color:"bg-blue-100 text-blue-700",icon:u.Z,text:"Bersumber"};case 4:return{color:"bg-purple-100 text-purple-700",icon:m.Z,text:"Terpercaya"};default:return{color:"bg-gray-100 text-gray-700",icon:c.Z,text:"Baru"}}})(b.trust_level||0),k=Z.icon,C=(null===(s=b.images)||void 0===s?void 0:s.find(e=>e.is_primary))||(null===(a=b.images)||void 0===a?void 0:a[0]),I=Math.ceil(b.content.length/200);return(0,t.jsxs)("div",{className:"story-card bg-white rounded-lg shadow-sm border border-gray-200 overflow-hidden cursor-pointer transition-all duration-200 hover:shadow-md hover:-translate-y-1 ".concat(y?"p-3":"p-4"),onClick:j,children:[C&&!w&&(0,t.jsxs)("div",{className:"relative ".concat(y?"h-32":"h-48"," mb-3 rounded-lg overflow-hidden bg-gray-100"),children:[(0,t.jsx)(n.default,{src:C.image_url,alt:b.title,fill:!0,className:"object-cover",onError:()=>_(!0)}),(0,t.jsx)("div",{className:"absolute top-2 right-2",children:(0,t.jsxs)("div",{className:"verification-badge ".concat(Z.color," flex items-center gap-1 text-xs font-medium px-2 py-1 rounded-full"),children:[(0,t.jsx)(k,{className:"w-3 h-3"}),Z.text]})})]}),(0,t.jsxs)("div",{className:"space-y-2",children:[(0,t.jsxs)("div",{className:"flex items-center justify-between text-xs",children:[(0,t.jsxs)("span",{className:"bg-indonesia-red bg-opacity-10 text-indonesia-red px-2 py-1 rounded-full font-medium",children:[null===(p=b.category)||void 0===p?void 0:p.icon," ",(null===(v=b.category)||void 0===v?void 0:v.name)||"Umum"]}),b.location&&(0,t.jsxs)("div",{className:"flex items-center gap-1 text-gray-500",children:[(0,t.jsx)(x.Z,{className:"w-3 h-3"}),(0,t.jsx)("span",{className:"truncate max-w-20",children:b.location.name})]})]}),(0,t.jsx)("h3",{className:"font-semibold text-gray-900 line-clamp-2 ".concat(y?"text-sm":"text-base"),children:b.title}),(0,t.jsx)("p",{className:"text-gray-600 line-clamp-3 ".concat(y?"text-xs":"text-sm"),children:b.summary||b.content.substring(0,150)+"..."}),b.time_period&&(0,t.jsxs)("div",{className:"flex items-center gap-1 text-xs text-gray-500",children:[(0,t.jsx)(o.Z,{className:"w-3 h-3"}),(0,t.jsx)("span",{children:b.time_period})]}),(0,t.jsxs)("div",{className:"flex items-center justify-between pt-2 border-t border-gray-100",children:[(0,t.jsxs)("div",{className:"flex items-center gap-3 text-xs text-gray-500",children:[(0,t.jsxs)("div",{className:"flex items-center gap-1",children:[(0,t.jsx)(u.Z,{className:"w-3 h-3"}),(0,t.jsxs)("span",{children:[I," menit"]})]}),(0,t.jsxs)("div",{className:"flex items-center gap-1",children:[(0,t.jsx)(h.Z,{className:"w-3 h-3"}),(0,t.jsx)("span",{children:b.view_count||0})]}),(0,t.jsxs)("div",{className:"flex items-center gap-1",children:[(0,t.jsx)(g.Z,{className:"w-3 h-3"}),(0,t.jsx)("span",{children:b.verification_count||0})]})]}),(0,t.jsx)("span",{className:"text-xs text-gray-400",children:(e=>{try{return(0,l.Q)(new Date(e),{addSuffix:!0,locale:i.id})}catch(e){return"Baru saja"}})(b.created_at||"")})]}),N&&b.author&&(0,t.jsxs)("div",{className:"flex items-center gap-2 pt-2 border-t border-gray-100",children:[(0,t.jsx)("div",{className:"w-6 h-6 bg-indonesia-gold rounded-full flex items-center justify-center",children:b.author.avatar_url?(0,t.jsx)(n.default,{src:b.author.avatar_url,alt:b.author.full_name||"User",width:24,height:24,className:"rounded-full object-cover"}):(0,t.jsx)(f.Z,{className:"w-3 h-3 text-white"})}),(0,t.jsx)("span",{className:"text-xs text-gray-600 truncate",children:b.author.full_name||b.author.username})]})]})]})}},5526:function(e,s,a){a.d(s,{IG:function(){return o},JU:function(){return c},Ry:function(){return d},Yb:function(){return u}});var t=a(7026),r=a(5452);let n="https://gaizwlstaujuiyxofkww.supabase.co",l="eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6ImdhaXp3bHN0YXVqdWl5eG9ma3d3Iiwicm9sZSI6ImFub24iLCJpYXQiOjE3NDg1NzcyMjMsImV4cCI6MjA2NDE1MzIyM30.34gO2ib2nbu6ZllpAhgoPoGDty_wnb6T0MYf7-ftXFw";if(!n||!l)throw Error("Missing Supabase environment variables");let i=(0,t.eI)(n,l,{auth:{autoRefreshToken:!0,persistSession:!0,detectSessionInUrl:!0},realtime:{params:{eventsPerSecond:10}}}),c=()=>(0,r.createClientComponentClient)(),o=async e=>{let{data:s,error:a}=await i.auth.signInWithOAuth({provider:e,options:{redirectTo:"".concat("http://localhost:3000","/auth/callback")}});return{data:s,error:a}},d=async(e,s)=>{let{data:a,error:t}=await i.auth.signInWithPassword({email:e,password:s});return{data:a,error:t}},u=async(e,s,a)=>{let{data:t,error:r}=await i.auth.signUp({email:e,password:s,options:{data:a,emailRedirectTo:"".concat("http://localhost:3000","/auth/callback")}});return{data:t,error:r}}}}]);